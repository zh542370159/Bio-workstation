output$mapping_dat <-renderDataTable(expr = data.frame())
dat_id <- reactiveValues()
dat_id$input <- NULL
dat_id$field_id <- 1

observeEvent(input$example_id,{
  updateTextAreaInput(session,inputId = "textArea_id",value = "ENSMUSG00000028649\nENSMUSG00000028649\nENSMUSG00000022477\nENSMUSG00000022622\nENSMUSG00000032110\nENSMUSG00000031972\nENSMUSG00000029580\nENSMUSG00000070979\nENSMUSG00000070980\nENSMUSG00000029106\nENSMUSG00000002844\nENSMUSG00000026496\nENSMUSG00000000731\nENSMUSG00000018428\nENSMUSG00000030344\nENSMUSG00000050089\nENSMUSG00000010025\nENSMUSG00000030695\nENSMUSG00000040888\nENSMUSG00000031633\nENSMUSG00000021866\nENSMUSG00000003033\nENSMUSG00000060279\nENSMUSG00000035960\nENSMUSG00000035960\nENSMUSG00000027193\nENSMUSG00000040383\nENSMUSG00000046532\nENSMUSG00000048076\nENSMUSG00000062421\nENSMUSG00000021877\nENSMUSG00000029467\nENSMUSG00000025428\nENSMUSG00000025393\nENSMUSG00000000568\nENSMUSG00000000568\nENSMUSG00000039781\nENSMUSG00000028416\nENSMUSG00000020650\nENSMUSG00000022557\nENSMUSG00000021127\nENSMUSG00000023175\nENSMUSG00000066979\nENSMUSG00000014226\nENSMUSG00000014226\nENSMUSG00000033952\nENSMUSG00000003814\nENSMUSG00000020368\nENSMUSG00000028656\nENSMUSG00000028745\nENSMUSG00000028745\nENSMUSG00000034101\nENSMUSG00000025907\nENSMUSG00000021258\nENSMUSG00000034024\nENSMUSG00000001416\nENSMUSG00000001416\nENSMUSG00000007739\nENSMUSG00000022234\nENSMUSG00000029447\nENSMUSG00000030007\nENSMUSG00000025613\nENSMUSG00000029062\nENSMUSG00000019471\nENSMUSG00000024081\nENSMUSG00000029253\nENSMUSG00000045193\nENSMUSG00000002190\nENSMUSG00000030057\nENSMUSG00000030057\nENSMUSG00000026837\nENSMUSG00000026042\nENSMUSG00000020241\nENSMUSG00000026553\nENSMUSG00000025586\nENSMUSG00000025586\nENSMUSG00000028607\nENSMUSG00000022048\nENSMUSG00000005683\nENSMUSG00000024974\nENSMUSG00000031078\nENSMUSG00000005506\nENSMUSG00000005506\nENSMUSG00000022174\nENSMUSG00000010592\nENSMUSG00000001666\nENSMUSG00000029169\nENSMUSG00000029169\nENSMUSG00000000787\nENSMUSG00000021758\nENSMUSG00000020719\nENSMUSG00000032097\nENSMUSG00000042699\nENSMUSG00000042699\nENSMUSG00000058454\nENSMUSG00000033826\nENSMUSG00000018707\nENSMUSG00000033335\nENSMUSG00000004099\nENSMUSG00000026209\nENSMUSG00000020457\nENSMUSG00000026131\nENSMUSG00000027479\nENSMUSG00000037742\nENSMUSG00000034994\nENSMUSG00000057561\nENSMUSG00000021116\nENSMUSG00000024991\nENSMUSG00000059796\nENSMUSG00000022884\nENSMUSG00000028156\nENSMUSG00000028156\nENSMUSG00000005610\nENSMUSG00000028029\nENSMUSG00000063524\nENSMUSG00000006445\nENSMUSG00000024382\nENSMUSG00000021131\nENSMUSG00000023443\nENSMUSG00000022332\nENSMUSG00000022191\nENSMUSG00000002107\nENSMUSG00000002107\nENSMUSG00000009079\nENSMUSG00000025153\nENSMUSG00000028676\nENSMUSG00000038274\nENSMUSG00000046865\nENSMUSG00000027204\nENSMUSG00000024598\nENSMUSG00000029147\nENSMUSG00000032966\nENSMUSG00000030357\nENSMUSG00000019428\nENSMUSG00000000838\nENSMUSG00000026193\nENSMUSG00000031590\nENSMUSG00000027680\nENSMUSG00000027680\nENSMUSG00000071650\nENSMUSG00000057666\nENSMUSG00000053624\nENSMUSG00000026473\nENSMUSG00000024158\nENSMUSG00000024429\nENSMUSG00000020372\nENSMUSG00000071657\nENSMUSG00000026000\nENSMUSG00000004268\nENSMUSG00000004270\nENSMUSG00000027248\nENSMUSG00000026864\nENSMUSG00000062203\nENSMUSG00000058135\nENSMUSG00000040562\nENSMUSG00000004032\nENSMUSG00000026219\nENSMUSG00000026219\nENSMUSG00000026219\nENSMUSG00000042535\nENSMUSG00000030264\nENSMUSG00000030264\nENSMUSG00000019188\nENSMUSG00000052565\nENSMUSG00000096210\nENSMUSG00000060743\nENSMUSG00000060743\nENSMUSG00000031161\nENSMUSG00000045835\nENSMUSG00000020267\nENSMUSG00000066551\nENSMUSG00000003038\nENSMUSG00000015217\nENSMUSG00000015217\nENSMUSG00000027875\nENSMUSG00000020330\nENSMUSG00000004070\nENSMUSG00000020737\nENSMUSG00000060373\nENSMUSG00000046434\nENSMUSG00000020358\nENSMUSG00000021546\nENSMUSG00000015165\nENSMUSG00000028759\nENSMUSG00000109324\nENSMUSG00000109324\nENSMUSG00000015656\nENSMUSG00000015656\nENSMUSG00000081984\nENSMUSG00000025980\nENSMUSG00000059970\nENSMUSG00000023944\nENSMUSG00000021270\nENSMUSG00000024359\nENSMUSG00000022721\nENSMUSG00000040028\nENSMUSG00000008489\nENSMUSG00000003410\nENSMUSG00000003410\nENSMUSG00000028546\nENSMUSG00000028546\nENSMUSG00000028546\nENSMUSG00000023830\nENSMUSG00000001741\nENSMUSG00000032178\nENSMUSG00000001440\nENSMUSG00000024660\nENSMUSG00000022336\nENSMUSG00000007670\nENSMUSG00000060012\nENSMUSG00000063077\nENSMUSG00000020821\nENSMUSG00000021693\nENSMUSG00000021693\nENSMUSG00000018362\nENSMUSG00000021929\nENSMUSG00000027782\nENSMUSG00000054146\nENSMUSG00000021843\nENSMUSG00000021843\nENSMUSG00000019899\nENSMUSG00000032518\nENSMUSG00000028059\nENSMUSG00000063229\nENSMUSG00000030851\nENSMUSG00000020697\nENSMUSG00000044533\nENSMUSG00000024590\nENSMUSG00000030263\nENSMUSG00000067367\nENSMUSG00000028609\nENSMUSG00000037236\nENSMUSG00000041859\nENSMUSG00000029730\nENSMUSG00000074435\nENSMUSG00000066441\nENSMUSG00000025241\nENSMUSG00000031004\nENSMUSG00000026743\nENSMUSG00000002227\nENSMUSG00000005370\nENSMUSG00000054256\nENSMUSG00000052727\nENSMUSG00000032479\nENSMUSG00000032479\nENSMUSG00000064068\nENSMUSG00000064068\nENSMUSG00000056342\nENSMUSG00000027201\nENSMUSG00000027201\nENSMUSG00000090841\nENSMUSG00000030761\nENSMUSG00000061315\nENSMUSG00000059119\nENSMUSG00000026234\nENSMUSG00000032216\nENSMUSG00000031644\nENSMUSG00000020936\nENSMUSG00000026643\nENSMUSG00000061032\nENSMUSG00000030016\nENSMUSG00000001228\nENSMUSG00000057113\nENSMUSG00000057113\nENSMUSG00000056209\nENSMUSG00000028851\nENSMUSG00000026790\nENSMUSG00000026790\nENSMUSG00000020456\nENSMUSG00000025757\nENSMUSG00000040463\nENSMUSG00000022283\nENSMUSG00000051732\nENSMUSG00000028691\nENSMUSG00000056851\nENSMUSG00000056851\nENSMUSG00000031592\nENSMUSG00000019795\nENSMUSG00000001151\nENSMUSG00000024975\nENSMUSG00000032504\nENSMUSG00000025047\nENSMUSG00000047674\nENSMUSG00000027805\nENSMUSG00000031233\nENSMUSG00000061904\nENSMUSG00000034403\nENSMUSG00000032294\nENSMUSG00000022565\nENSMUSG00000025364\nENSMUSG00000020994\nENSMUSG00000038644\nENSMUSG00000032383\nENSMUSG00000014956\nENSMUSG00000004455\nENSMUSG00000050058\nENSMUSG00000021413\nENSMUSG00000028932\nENSMUSG00000020708\nENSMUSG00000006498\nENSMUSG00000006498\nENSMUSG00000006498\nENSMUSG00000049775\nENSMUSG00000004044\nENSMUSG00000043991\nENSMUSG00000094483\nENSMUSG00000062078\nENSMUSG00000077450\nENSMUSG00000027593\nENSMUSG00000029430\nENSMUSG00000003226\nENSMUSG00000022391\nENSMUSG00000030779\nENSMUSG00000030779\nENSMUSG00000031167\nENSMUSG00000032582\nENSMUSG00000031134\nENSMUSG00000037070\nENSMUSG00000031586\nENSMUSG00000029191\nENSMUSG00000058301\nENSMUSG00000034681\nENSMUSG00000037805\nENSMUSG00000059070\nENSMUSG00000017404\nENSMUSG00000041453\nENSMUSG00000028936\nENSMUSG00000037772\nENSMUSG00000060938\nENSMUSG00000060938\nENSMUSG00000063316\nENSMUSG00000030432\nENSMUSG00000058600\nENSMUSG00000057841\nENSMUSG00000046330\nENSMUSG00000029614\nENSMUSG00000043716\nENSMUSG00000047215\nENSMUSG00000027642\nENSMUSG00000005198\nENSMUSG00000022205\nENSMUSG00000024608\nENSMUSG00000063457\nENSMUSG00000063457\nENSMUSG00000037563\nENSMUSG00000025290\nENSMUSG00000028081\nENSMUSG00000031320\nENSMUSG00000012848\nENSMUSG00000028495\nENSMUSG00000047675\nENSMUSG00000028790\nENSMUSG00000020211\nENSMUSG00000020088\nENSMUSG00000039148\nENSMUSG00000042605\nENSMUSG00000027500\nENSMUSG00000022390\nENSMUSG00000034120\nENSMUSG00000071172\nENSMUSG00000021134\nENSMUSG00000027288\nENSMUSG00000030638\nENSMUSG00000022858\nENSMUSG00000022858\nENSMUSG00000004642\nENSMUSG00000003153\nENSMUSG00000020265\nENSMUSG00000020929\nENSMUSG00000020929\nENSMUSG00000024217\nENSMUSG00000063511\nENSMUSG00000008333\nENSMUSG00000002477\nENSMUSG00000090553\nENSMUSG00000022961\nENSMUSG00000060147\nENSMUSG00000020315\nENSMUSG00000026915\nENSMUSG00000026915\nENSMUSG00000004865\nENSMUSG00000062604\nENSMUSG00000068882\nENSMUSG00000063480\nENSMUSG00000062939\nENSMUSG00000039536\nENSMUSG00000039536\nENSMUSG00000024966\nENSMUSG00000027496\nENSMUSG00000030224\nENSMUSG00000022110\nENSMUSG00000003435\nENSMUSG00000002052\nENSMUSG00000036160\nENSMUSG00000026547\nENSMUSG00000023051\nENSMUSG00000000384\nENSMUSG00000059540\nENSMUSG00000036309\nENSMUSG00000020923\nENSMUSG00000068039\nENSMUSG00000068039\nENSMUSG00000062859\nENSMUSG00000079707\nENSMUSG00000005161\nENSMUSG00000025134\nENSMUSG00000025134\nENSMUSG00000020799\nENSMUSG00000027719\nENSMUSG00000062270\nENSMUSG00000006998\nENSMUSG00000003923\nENSMUSG00000071337\nENSMUSG00000030846\nENSMUSG00000029833\nENSMUSG00000005566\nENSMUSG00000030516\nENSMUSG00000027528\nENSMUSG00000028465\nENSMUSG00000019961\nENSMUSG00000043050\nENSMUSG00000070544\nENSMUSG00000020914\nENSMUSG00000022779\nENSMUSG00000023456\nENSMUSG00000041763\nENSMUSG00000020048\nENSMUSG00000024033\nENSMUSG00000026374\nENSMUSG00000059891\nENSMUSG00000074129\nENSMUSG00000022570\nENSMUSG00000026803\nENSMUSG00000038379\nENSMUSG00000051747\nENSMUSG00000043091\nENSMUSG00000067338\nENSMUSG00000001525\nENSMUSG00000028367\nENSMUSG00000030435\nENSMUSG00000005575\nENSMUSG00000038965\nENSMUSG00000001924\nENSMUSG00000031826\nENSMUSG00000024501\nENSMUSG00000032612\nENSMUSG00000044894\nENSMUSG00000031010\nENSMUSG00000028955\nENSMUSG00000007029\nENSMUSG00000021823\nENSMUSG00000021771\nENSMUSG00000008892\nENSMUSG00000026728\nENSMUSG00000026728\nENSMUSG00000021115\nENSMUSG00000040731\nENSMUSG00000040731\nENSMUSG00000002748\nENSMUSG00000016458\nENSMUSG00000051768\nENSMUSG00000028639\nENSMUSG00000076432\nENSMUSG00000022285\nENSMUSG00000024949\nENSMUSG00000024949\nENSMUSG00000024949\nENSMUSG00000017421\nENSMUSG00000017421\nENSMUSG00000037001\nENSMUSG00000022201\nENSMUSG00000029014\nENSMUSG00000029860\nENSMUSG00000038914\nENSMUSG00000026245\nENSMUSG00000018765\nENSMUSG00000029405\nENSMUSG00000029405\nENSMUSG00000062867\nENSMUSG00000021918\nENSMUSG00000032959\nENSMUSG00000051695\nENSMUSG00000002731\nENSMUSG00000025487\nENSMUSG00000024474\nENSMUSG00000073079\nENSMUSG00000028845\nENSMUSG00000032410\nENSMUSG00000027433\nENSMUSG00000063358\nENSMUSG00000021911\nENSMUSG00000046364\nENSMUSG00000069045\nENSMUSG00000015937\nENSMUSG00000015937\nENSMUSG00000021481\nENSMUSG00000005417\nENSMUSG00000003970\nENSMUSG00000018583\nENSMUSG00000030744\nENSMUSG00000062647\nENSMUSG00000003429\nENSMUSG00000028668\nENSMUSG00000041645\nENSMUSG00000060036\nENSMUSG00000005374\nENSMUSG00000025362\nENSMUSG00000033845\nENSMUSG00000030879\nENSMUSG00000002767\nENSMUSG00000028953\nENSMUSG00000001751\nENSMUSG00000024369\nENSMUSG00000007050\nENSMUSG00000041506\nENSMUSG00000052488\nENSMUSG00000096145\nENSMUSG00000026127\nENSMUSG00000027968\nENSMUSG00000001783\nENSMUSG00000033949\nENSMUSG00000021595\nENSMUSG00000025869\nENSMUSG00000000552\nENSMUSG00000025920\nENSMUSG00000025920\nENSMUSG00000022385\nENSMUSG00000000365\nENSMUSG00000000365\nENSMUSG00000020388\nENSMUSG00000020949\nENSMUSG00000042354\nENSMUSG00000036376\nENSMUSG00000032101\nENSMUSG00000024091\nENSMUSG00000046756\nENSMUSG00000036181\nENSMUSG00000051627\nENSMUSG00000031848\nENSMUSG00000031848\nENSMUSG00000024837\nENSMUSG00000045302\nENSMUSG00000027714\nENSMUSG00000017264\nENSMUSG00000029328\nENSMUSG00000029328\nENSMUSG00000028693\nENSMUSG00000052997\nENSMUSG00000041781\nENSMUSG00000007564\nENSMUSG00000028809\nENSMUSG00000039630\nENSMUSG00000039630\nENSMUSG00000036202\nENSMUSG00000028034\nENSMUSG00000027676\nENSMUSG00000027331\nENSMUSG00000054770\nENSMUSG00000024165\nENSMUSG00000022033\nENSMUSG00000039220\nENSMUSG00000033931\nENSMUSG00000031563\nENSMUSG00000026634\nENSMUSG00000004393\nENSMUSG00000052253\nENSMUSG00000001056\nENSMUSG00000044763\nENSMUSG00000063334\nENSMUSG00000034723\nENSMUSG00000041360\nENSMUSG00000027998\nENSMUSG00000010097\nENSMUSG00000070319\nENSMUSG00000042632\nENSMUSG00000004980\nENSMUSG00000025289\nENSMUSG00000023988\nENSMUSG00000027030\nENSMUSG00000030082\nENSMUSG00000018554\nENSMUSG00000018554\nENSMUSG00000056820\nENSMUSG00000020193\nENSMUSG00000061479\nENSMUSG00000031311\nENSMUSG00000038784\nENSMUSG00000038784\nENSMUSG00000024393\nENSMUSG00000019432\nENSMUSG00000030137\nENSMUSG00000028180\nENSMUSG00000027184\nENSMUSG00000027905\nENSMUSG00000067288\nENSMUSG00000072770\nENSMUSG00000016541\nENSMUSG00000029625\nENSMUSG00000002625\nENSMUSG00000022194\nENSMUSG00000022194\nENSMUSG00000030654\nENSMUSG00000038708\nENSMUSG00000057863\nENSMUSG00000024800\nENSMUSG00000029290\nENSMUSG00000038994\nENSMUSG00000029922\nENSMUSG00000037062\nENSMUSG00000016554\nENSMUSG00000027531\nENSMUSG00000026020\nENSMUSG00000060244\nENSMUSG00000020475\nENSMUSG00000028651\nENSMUSG00000029407\nENSMUSG00000024498\nENSMUSG00000022913\nENSMUSG00000020706\nENSMUSG00000027510\nENSMUSG00000025272\nENSMUSG00000061136\nENSMUSG00000028134\nENSMUSG00000020075\nENSMUSG00000022185\nENSMUSG00000028943\nENSMUSG00000045427\nENSMUSG00000006456\nENSMUSG00000021552\nENSMUSG00000028622\nENSMUSG00000030045\nENSMUSG00000036112\nENSMUSG00000036112\nENSMUSG00000018697\nENSMUSG00000030738\nENSMUSG00000025035\nENSMUSG00000071072\nENSMUSG00000014195\nENSMUSG00000030663\nENSMUSG00000040761\nENSMUSG00000024045\nENSMUSG00000032423\nENSMUSG00000032423\nENSMUSG00000032423\nENSMUSG00000032423\nENSMUSG00000036285\nENSMUSG00000027951\nENSMUSG00000021196\nENSMUSG00000019977\nENSMUSG00000027282\nENSMUSG00000049550\nENSMUSG00000031701\nENSMUSG00000030189\nENSMUSG00000030189\nENSMUSG00000052738\nENSMUSG00000009013\nENSMUSG00000052833\nENSMUSG00000001424\nENSMUSG00000030079\nENSMUSG00000040043\nENSMUSG00000040043\nENSMUSG00000021244\nENSMUSG00000019809\nENSMUSG00000021476\nENSMUSG00000058773\nENSMUSG00000023467\nENSMUSG00000027763\nENSMUSG00000026970\nENSMUSG00000026970\nENSMUSG00000024002\nENSMUSG00000090733\nENSMUSG00000031533\nENSMUSG00000024312\nENSMUSG00000028911\nENSMUSG00000027387\nENSMUSG00000095567\nENSMUSG00000095567\nENSMUSG00000033644\nENSMUSG00000029423\nENSMUSG00000024999\nENSMUSG00000028259\nENSMUSG00000060636\nENSMUSG00000027722\nENSMUSG00000020832\nENSMUSG00000015597\nENSMUSG00000026174\nENSMUSG00000032285\nENSMUSG00000049807\nENSMUSG00000004934\nENSMUSG00000007850\nENSMUSG00000061024\nENSMUSG00000047187\nENSMUSG00000015092\nENSMUSG00000002963\nENSMUSG00000060739\nENSMUSG00000021731\nENSMUSG00000027940\nENSMUSG00000001120\nENSMUSG00000030216\nENSMUSG00000038374\nENSMUSG00000060791\nENSMUSG00000076436\nENSMUSG00000023723\nENSMUSG00000020430\nENSMUSG00000071415\nENSMUSG00000070697\nENSMUSG00000037361\nENSMUSG00000004096\nENSMUSG00000012422\nENSMUSG00000065990\nENSMUSG00000028826\nENSMUSG00000003299\nENSMUSG00000027133\nENSMUSG00000063171\nENSMUSG00000040720\nENSMUSG00000008822\nENSMUSG00000053317\nENSMUSG00000063888\nENSMUSG00000067194\nENSMUSG00000049960\nENSMUSG00000020982\nENSMUSG00000020982\nENSMUSG00000063802\nENSMUSG00000054277\nENSMUSG00000021692\nENSMUSG00000035642\nENSMUSG00000071653\nENSMUSG00000025591\nENSMUSG00000021039\nENSMUSG00000030980\nENSMUSG00000041084\nENSMUSG00000049643\nENSMUSG00000000339\nENSMUSG00000091625\nENSMUSG00000014504\nENSMUSG00000025193\nENSMUSG00000069833\nENSMUSG00000028861\nENSMUSG00000005846\nENSMUSG00000024902\nENSMUSG00000036873\nENSMUSG00000049517\nENSMUSG00000071528\nENSMUSG00000049751\nENSMUSG00000062997\nENSMUSG00000001017\nENSMUSG00000024654\nENSMUSG00000038545\nENSMUSG00000031984\nENSMUSG00000051518\nENSMUSG00000026655\nENSMUSG00000024914\nENSMUSG00000045624\nENSMUSG00000028959\nENSMUSG00000028959\nENSMUSG00000078923\nENSMUSG00000003808\nENSMUSG00000038150\nENSMUSG00000021938\nENSMUSG00000055762\nENSMUSG00000032212\nENSMUSG00000036323\nENSMUSG00000027509\nENSMUSG00000026867\nENSMUSG00000033760\nENSMUSG00000059395\nENSMUSG00000025337\nENSMUSG00000047025\nENSMUSG00000001558\nENSMUSG00000024815\nENSMUSG00000031631\nENSMUSG00000031631\nENSMUSG00000029089\nENSMUSG00000024604\nENSMUSG00000001472\nENSMUSG00000027006\nENSMUSG00000036371\nENSMUSG00000036371\nENSMUSG00000020783\nENSMUSG00000001767\nENSMUSG00000051223\nENSMUSG00000021484\nENSMUSG00000029227\nENSMUSG00000029227\nENSMUSG00000029227\nENSMUSG00000032527\nENSMUSG00000022516\nENSMUSG00000027881\nENSMUSG00000073758\nENSMUSG00000001674\nENSMUSG00000042396\nENSMUSG00000022724\nENSMUSG00000000439\nENSMUSG00000018882\nENSMUSG00000010608\nENSMUSG00000055065\nENSMUSG00000024056\nENSMUSG00000029247\nENSMUSG00000066568\nENSMUSG00000052146\nENSMUSG00000025794\nENSMUSG00000027405\nENSMUSG00000018322\nENSMUSG00000038646\nENSMUSG00000029440\nENSMUSG00000022255\nENSMUSG00000059482\nENSMUSG00000071644\nENSMUSG00000009076\nENSMUSG00000022635\nENSMUSG00000038305\nENSMUSG00000074656\nENSMUSG00000028907\nENSMUSG00000024528\nENSMUSG00000027981\nENSMUSG00000027981\nENSMUSG00000038510\nENSMUSG00000038510\nENSMUSG00000020608\nENSMUSG00000031527\nENSMUSG00000041841\nENSMUSG00000049957\nENSMUSG00000043384\nENSMUSG00000047126\nENSMUSG00000022000\nENSMUSG00000027498\nENSMUSG00000028523\nENSMUSG00000037316\nENSMUSG00000038046\nENSMUSG00000032042\nENSMUSG00000033436\nENSMUSG00000015757\nENSMUSG00000028234\nENSMUSG00000027828\nENSMUSG00000019470\nENSMUSG00000026516\nENSMUSG00000002129\nENSMUSG00000018425\nENSMUSG00000040359\nENSMUSG00000010554\nENSMUSG00000045107\nENSMUSG00000046173\nENSMUSG00000014763\nENSMUSG00000033578\nENSMUSG00000041718\nENSMUSG00000020300\nENSMUSG00000028264\nENSMUSG00000034192\nENSMUSG00000020863\nENSMUSG00000024885\nENSMUSG00000066368\nENSMUSG00000022325\nENSMUSG00000035179\nENSMUSG00000023186\nENSMUSG00000001016\nENSMUSG00000040699\nENSMUSG00000026353\nENSMUSG00000022247\nENSMUSG00000021967\nENSMUSG00000019297\nENSMUSG00000037720\nENSMUSG00000032399\nENSMUSG00000009535\nENSMUSG00000028779\nENSMUSG00000074682\nENSMUSG00000031578\nENSMUSG00000003039\nENSMUSG00000034913\nENSMUSG00000036781\nENSMUSG00000034401\nENSMUSG00000026377\nENSMUSG00000022024\nENSMUSG00000032407\nENSMUSG00000002524\nENSMUSG00000002524\nENSMUSG00000030521\nENSMUSG00000016921\nENSMUSG00000039221\nENSMUSG00000036733\nENSMUSG00000021807\nENSMUSG00000024273\nENSMUSG00000090862\nENSMUSG00000041560\nENSMUSG00000038683\nENSMUSG00000022774\nENSMUSG00000020156\nENSMUSG00000036572\nENSMUSG00000036572\nENSMUSG00000022312\nENSMUSG00000028010\nENSMUSG00000039209\nENSMUSG00000023118\nENSMUSG00000098274\nENSMUSG00000027349\nENSMUSG00000031754\nENSMUSG00000026969\nENSMUSG00000030859\nENSMUSG00000062651\nENSMUSG00000070708\nENSMUSG00000021748\nENSMUSG00000031831\nENSMUSG00000029701\nENSMUSG00000000751\nENSMUSG00000028688\nENSMUSG00000005481\nENSMUSG00000032437\nENSMUSG00000039205\nENSMUSG00000062006\nENSMUSG00000026966\nENSMUSG00000061360\nENSMUSG00000022370\nENSMUSG00000026039\nENSMUSG00000037857\nENSMUSG00000023967\nENSMUSG00000028821\nENSMUSG00000054405\nENSMUSG00000024181\nENSMUSG00000071659\nENSMUSG00000021257\nENSMUSG00000036777\nENSMUSG00000038828\nENSMUSG00000002455\nENSMUSG00000028433\nENSMUSG00000022204\nENSMUSG00000018433\nENSMUSG00000030512\nENSMUSG00000008373\nENSMUSG00000021917\nENSMUSG00000036372\nENSMUSG00000028729\nENSMUSG00000027091\nENSMUSG00000066036\nENSMUSG00000026248\nENSMUSG00000021149\nENSMUSG00000020878\nENSMUSG00000048686\nENSMUSG00000074576\nENSMUSG00000048155\nENSMUSG00000060715\nENSMUSG00000041297\nENSMUSG00000029504\nENSMUSG00000022800\nENSMUSG00000022800\nENSMUSG00000020018\nENSMUSG00000028741\nENSMUSG00000033987\nENSMUSG00000063884\nENSMUSG00000053030\nENSMUSG00000037443\nENSMUSG00000048077\nENSMUSG00000063200\nENSMUSG00000034349\nENSMUSG00000022792\nENSMUSG00000069565\nENSMUSG00000028187\nENSMUSG00000035890\nENSMUSG00000034889\nENSMUSG00000035093\nENSMUSG00000022403\nENSMUSG00000039179\nENSMUSG00000020680\nENSMUSG00000048327\nENSMUSG00000030662\nENSMUSG00000102976\nENSMUSG00000011306\nENSMUSG00000050549\nENSMUSG00000029427\nENSMUSG00000045210\nENSMUSG00000004356\nENSMUSG00000038759\nENSMUSG00000015748\nENSMUSG00000015176\nENSMUSG00000048731\nENSMUSG00000049940\nENSMUSG00000038069\nENSMUSG00000021392\nENSMUSG00000024764\nENSMUSG00000071749\nENSMUSG00000020037\nENSMUSG00000022141\nENSMUSG00000024352\nENSMUSG00000006676\nENSMUSG00000028820\nENSMUSG00000055862\nENSMUSG00000023932\nENSMUSG00000038446\nENSMUSG00000029703\nENSMUSG00000025404\nENSMUSG00000010205\nENSMUSG00000035152\nENSMUSG00000019139\nENSMUSG00000028898\nENSMUSG00000029624\nENSMUSG00000002372\nENSMUSG00000039715\nENSMUSG00000062190\nENSMUSG00000042708\nENSMUSG00000024175\nENSMUSG00000020571\nENSMUSG00000020114\nENSMUSG00000055538\nENSMUSG00000034173\nENSMUSG00000032387\nENSMUSG00000032044\nENSMUSG00000029599\nENSMUSG00000053931\nENSMUSG00000039286\nENSMUSG00000020705\nENSMUSG00000020166\nENSMUSG00000027770\nENSMUSG00000028706\nENSMUSG00000033228\nENSMUSG00000016018\nENSMUSG00000067150\nENSMUSG00000033909\nENSMUSG00000046667\nENSMUSG00000024120\nENSMUSG00000058392\nENSMUSG00000041057\nENSMUSG00000063785\nENSMUSG00000037608\nENSMUSG00000051934\nENSMUSG00000031095\nENSMUSG00000031095\nENSMUSG00000041912\nENSMUSG00000041912\nENSMUSG00000074480\nENSMUSG00000024095\nENSMUSG00000002017\nENSMUSG00000021072\nENSMUSG00000032480\nENSMUSG00000032480\nENSMUSG00000029028\nENSMUSG00000078451\nENSMUSG00000018509\nENSMUSG00000037331\nENSMUSG00000053553\nENSMUSG00000069041\nENSMUSG00000062154\nENSMUSG00000034848\nENSMUSG00000034848\nENSMUSG00000025995\nENSMUSG00000021243\nENSMUSG00000002240\nENSMUSG00000028678\nENSMUSG00000041815\nENSMUSG00000030590\nENSMUSG00000041343\nENSMUSG00000036990\nENSMUSG00000022789\nENSMUSG00000034292\nENSMUSG00000022536\nENSMUSG00000028948\nENSMUSG00000032514\nENSMUSG00000010796\nENSMUSG00000025480\nENSMUSG00000024989\nENSMUSG00000024989\nENSMUSG00000029594\nENSMUSG00000015127\nENSMUSG00000028423\nENSMUSG00000022487\nENSMUSG00000020454\nENSMUSG00000020454\nENSMUSG00000022119\nENSMUSG00000003604\nENSMUSG00000024400\nENSMUSG00000066037\nENSMUSG00000024054\nENSMUSG00000042520\nENSMUSG00000021572\nENSMUSG00000021838\nENSMUSG00000095365\nENSMUSG00000037531\nENSMUSG00000066643\nENSMUSG00000054003\nENSMUSG00000022455\nENSMUSG00000041328\nENSMUSG00000018040\nENSMUSG00000063273\nENSMUSG00000063273\nENSMUSG00000039555\nENSMUSG00000060176\nENSMUSG00000028902\nENSMUSG00000031330\nENSMUSG00000028106\nENSMUSG00000067909\nENSMUSG00000038500\nENSMUSG00000038500\nENSMUSG00000018921\nENSMUSG00000025977\nENSMUSG00000025977\nENSMUSG00000036693\nENSMUSG00000035139\nENSMUSG00000027564\nENSMUSG00000031991\nENSMUSG00000026894")
  updateSelectInput(session,inputId="species_id",selected = "Mouse")
  updateSelectInput(session,inputId="from_id",selected = "ENSEMBL_gene")
  updateCheckboxGroupButtons(session, "to_id", selected = c("Gene_Symbol","Gene_name","ENTREZID","ENSEMBL_gene","UniprotID"))
})


# observeEvent(input$input_id,{
#   reset('fileInput_id')
# })

observeEvent(input$textArea_id,{
  if (gsub(pattern = "\\s",replacement = "",x = input$textArea_id,perl = T)!="") {
    dat_id$input_1 <- read.table(text=input$textArea_id,header = F,fill = T,stringsAsFactors = F)
    dat_id$field_id <- 1
    # output$mapping_dat <-renderDataTable(expr = data.frame(dat_id$input[[dat_id$field_id]]))
  }
},ignoreInit = TRUE)

observeEvent(input$fileInput_id,{
  inFile <- input$fileInput_id
  header <- switch(input$fileheader_id,"Yes"=TRUE,"No"=FALSE)
  sep <- switch(input$filesep_id,"Tab"="\t","Comma"=";")
  dat_id$input_2 <- read.table(inFile$datapath, header = header,sep=sep,stringsAsFactors = F,fill = T,quote = "")
  updateSelectInput(session, "field_id", choices = colnames(dat_id$input_2))
}, ignoreInit = TRUE)

observeEvent(input$field_id,{
  dat_id$field_id <- input$field_id
})

observeEvent(input$select_all_id, {
  if (input$select_all_id){
    updateCheckboxGroupButtons(session, "to_id", selected = fields_ID)
  } else {
    updateCheckboxGroupButtons(session, "to_id", selected = character(0))
  }
}, ignoreInit = TRUE)

observeEvent(input$submit,{
  withBusyIndicatorServer("submit",{
    
    species_id <- switch(input$species_id,"Human"="human","Mouse"="mouse")
    if (input$input_id=="text") {
      dat_id$input <- dat_id$input_1
    }else{
      dat_id$input <- dat_id$input_2
    }
    if (!is.null(dat_id$input)) {
      
      output$mapping_dat <-renderDataTable(expr = NULL)
      dat_id$input$ID_mapping <- ">>>>>>"
      dat_id$output<- ID_conversion(ids_0 = dat_id$input[[dat_id$field_id]],
                                    key_type = input$from_id,
                                    out_types = input$to_id,
                                    species = species_id)
      dat_id$output_summary <- paste("Number of input unique/total IDs:  ",length(unique(dat_id$input[[dat_id$field_id]])),"/",length(dat_id$input[[dat_id$field_id]]),"<br/>","Number of mapped IDs (unique)  : ",nrow(dat_id$output),"<br/>","Number of unmapped IDs (unique)  : ",length(unique(dat_id$input[[dat_id$field_id]]))-nrow(dat_id$output))
      output$mapping_dat <-renderDataTable(expr = dat_id$output,  
                                           selection = 'single',
                                           style = 'bootstrap',
                                           extensions = c('ColReorder',"FixedHeader"),
                                           callback = JS('table.page(5).draw(false);'),
                                           options = list(
                                             #dom = 'Bfrtip',
                                             colReorder = TRUE,
                                             fixedHeader = TRUE,
                                             searchHighlight = TRUE,
                                             #pageLength = 10,
                                             autoWidth = F,
                                             scrollX='400px',
                                             lengthChange = TRUE,
                                             initComplete = JS(
                                               "function(settings, json) {",
                                               "$(this.api().table().header()).css({'font-size': '90%'});",
                                               "$(this.api().table().body()).css({'font-size': '90%'});",
                                               "}"),
                                             rowCallback = JS("function(r,d) {$(r).attr('height', '50px')}"),
                                             columnDefs = list(list(
                                               targets = "_all",
                                               width = '100px',
                                               render = JS(
                                                 "function(data, type, row, meta) {",
                                                 "return type === 'display' && data.length > 20 ?",
                                                 "'<span title=\"' + data + '\">' + data.substr(0, 20) + '...</span>' : data;",
                                                 "}")))
                                           )
      )
    }else{
      output$mapping_dat <-renderDataTable(expr = data.frame())
    }
  })
})

output$output_summary <- renderUI({HTML(dat_id$output_summary)})

datadownload <- reactive({
  switch(input$out_dataset,
         "Mapping table"=dat_id$output,
         "Mapping table merged with input data"= merge(x = dat_id$input,by.x=dat_id$field_id,y = dat_id$output,by.y="rawID",all=T),
         "Unmapped IDs"=data.frame(unmappedID=setdiff(x=unique(dat_id$input[[dat_id$field_id]]),y=dat_id$output[["rawID"]]))
  )
})

output$downloadData <- downloadHandler(
  filename = function() {
    paste(input$out_dataset, input$out_filetype, sep = ".")
  },
  content = function(file) {
    sep <- switch(input$out_filetype, "csv" = ",", "tsv" = "\t")
    write.table(datadownload(), file, sep = sep,
                row.names = FALSE)
  }
)